<!DOCTYPE html>
<html>
<head>
    <title>Debug Storage</title>
</head>
<body>
    <h1>Storage Debug</h1>
    <button id="checkStorage">Check Storage</button>
    <button id="checkAuth">Check Auth</button>
    <button id="enableRealtime">Enable Realtime Sync</button>
    <div id="output"></div>
    
    <script>
        const output = document.getElementById('output');
        
        document.getElementById('checkStorage').onclick = async () => {
            try {
                const result = await chrome.storage.local.get(['sync_github_config', 'syncConfig']);
                output.innerHTML = '<h2>Storage Contents:</h2><pre>' + JSON.stringify(result, null, 2) + '</pre>';
            } catch (error) {
                output.innerHTML = '<p>Error: ' + error.message + '</p>';
            }
        };
        
        document.getElementById('checkAuth').onclick = async () => {
            try {
                const response = await new Promise((resolve) => {
                    chrome.runtime.sendMessage({ action: 'getSyncStatus' }, resolve);
                });
                const realtimeResponse = await new Promise((resolve) => {
                    chrome.runtime.sendMessage({ action: 'getRealtimeSyncStatus' }, resolve);
                });
                
                output.innerHTML = `
                    <h2>Sync Status:</h2>
                    <pre>${JSON.stringify(response, null, 2)}</pre>
                    <h2>Realtime Status:</h2>
                    <pre>${JSON.stringify(realtimeResponse, null, 2)}</pre>
                `;
            } catch (error) {
                output.innerHTML = '<p>Error: ' + error.message + '</p>';
            }
        };
        
        document.getElementById('enableRealtime').onclick = async () => {
            try {
                const response = await new Promise((resolve) => {
                    chrome.runtime.sendMessage({ action: 'enableRealtimeSync' }, resolve);
                });
                output.innerHTML = '<h2>Enable Realtime Sync Result:</h2><pre>' + JSON.stringify(response, null, 2) + '</pre>';
            } catch (error) {
                output.innerHTML = '<p>Error: ' + error.message + '</p>';
            }
        };
    </script>
</body>
</html>